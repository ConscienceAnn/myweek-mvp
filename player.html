<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üé¨ –¢–≤–æ—è –Ω–µ–¥–µ–ª—è –∫–∞–∫...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        #videoPlayer {
            max-width: 100%;
            height: auto;
            background: #000;
            display: block;
        }
        #shareBtn, #restartBtn {
            padding: 12px 24px;
            margin: 10px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        #shareBtn { background: #ff5e5b; color: white; }
        #restartBtn { background: #4CAF50; color: white; }
    </style>
</head>
<body>
    <div id="playerContainer">
        <video id="videoPlayer" playsinline></video>
    </div>

    <script>
        const BASE_URL = "https://conscienceann.github.io/myweek-mvp/videos/";
        // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò [USER] –Ω–∞ —Å–≤–æ–π GitHub username (—Å–¥–µ–ª–∞–µ–º –Ω–∞ —à–∞–≥–µ 4)

        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('id') || 'test123';

        // –î–ª—è MVP ‚Äî —Ö—Ä–∞–Ω–∏–º –≤—ã–±–æ—Ä—ã –ø—Ä—è–º–æ –≤ URL (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ fetch –ø–æ–∑–∂–µ)
        const mood1 = urlParams.get('m1') || '1';
        const mood2 = urlParams.get('m2') || '2';
        const mood3 = urlParams.get('m3') || '3';

        const videoMap = {
            intro: `${BASE_URL}intro.mp4`,
            mood_1: `${BASE_URL}mood_1.mp4`,
            mood_2: `${BASE_URL}mood_2.mp4`,
            mood_3: `${BASE_URL}mood_3.mp4`,
            outro: `${BASE_URL}outro.mp4`
        };

        const sequence = [
            'intro',
            `mood_${mood1}`,
            `mood_${mood2}`,
            `mood_${mood3}`,
            'outro'
        ];

        let currentVideoIndex = 0;
        const videoPlayer = document.getElementById('videoPlayer');
        const playerContainer = document.getElementById('playerContainer');

        function playNextVideo() {
            if (currentVideoIndex >= sequence.length) {
                showEndScreen();
                return;
            }

            const key = sequence[currentVideoIndex];
            const url = videoMap[key];

            if (!url) {
                console.error(`–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ: ${key}`);
                currentVideoIndex++;
                playNextVideo();
                return;
            }

            videoPlayer.src = url;
            videoPlayer.play().catch(e => {
                // –ï—Å–ª–∏ –∞–≤—Ç–æ–ø–ª–µ–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                playerContainer.innerHTML = `
                    <button onclick="document.getElementById('videoPlayer').play(); this.remove();" style="padding: 15px 30px; font-size: 18px; background: #ff5e5b; color: white; border: none; border-radius: 8px; cursor: pointer;">
                        ‚ñ∂Ô∏è –ù–∞–∂–º–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å
                    </button>
                    <video id="videoPlayer" playsinline style="width: 100%; max-width: 600px; margin-top: 20px;"></video>
                `;
            });

            videoPlayer.addEventListener('ended', () => {
                currentVideoIndex++;
                playNextVideo();
            });
        }

        function showEndScreen() {
            playerContainer.innerHTML = `
                <div style="color: white; text-align: center; padding: 20px;">
                    <h2>üé¨ –¢–≤–æ—è –Ω–µ–¥–µ–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
                    <button id="shareBtn">üì≤ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                    <button id="restartBtn">üîÑ –ù–æ–≤–∞—è –Ω–µ–¥–µ–ª—è</button>
                </div>
            `;

            document.getElementById('shareBtn').addEventListener('click', shareResult);
            document.getElementById('restartBtn').addEventListener('click', () => {
                window.location.href = 'https://t.me/—Ç–≤–æ–π_–±–æ—Ç'; // –∑–∞–º–µ–Ω–∏ –ø–æ–∑–∂–µ
            });
        }

        function shareResult() {
            const shareText = `–ú–û–Ø –ù–ï–î–ï–õ–Ø –ö–ê–ö...\n–ü–Ω: –∫–∞–∫ —Ç–µ–ª–µ—Ñ–æ–Ω —Å 3% üì±\n–í—Ç: –∫–∞–∫ –∫–æ—Ç –Ω–∞ —Å–æ–ª–Ω—Ü–µ üê±\n–°—Ä: –∫–∞–∫ –≥–µ—Ä–æ–π üéÆ\n#–ú–æ—è–ù–µ–¥–µ–ª—è–ö–∞–∫\n${window.location.href}`;
            if (navigator.share) {
                navigator.share({ title: '–ú–æ—è –Ω–µ–¥–µ–ª—è –∫–∞–∫...', text: shareText });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ! –í—Å—Ç–∞–≤—å –≤ —á–∞—Ç –∏–ª–∏ —Å—Ç–æ—Ä–∏—Å ‚úÖ");
                });
            }
        }

        // –°—Ç–∞—Ä—Ç—É–µ–º!
        playNextVideo();
    </script>
</body>
</html>