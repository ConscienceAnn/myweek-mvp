<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üé¨ –¢–≤–æ—è –Ω–µ–¥–µ–ª—è –∫–∞–∫...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        #videoPlayer {
            max-width: 100%;
            height: auto;
            background: #000;
            display: block;
        }
        #shareBtn, #restartBtn {
            padding: 12px 24px;
            margin: 10px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        #shareBtn { background: #ff5e5b; color: white; }
        #restartBtn { background: #4CAF50; color: white; }
    </style>
</head>
<body>
    <!-- üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 1: –î–æ–±–∞–≤–ª–µ–Ω –∞—Ç—Ä–∏–±—É—Ç `muted` ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∞–≤—Ç–æ–ø–ª–µ—è –Ω–∞ iOS/Android -->
    <div id="playerContainer">
        <video id="videoPlayer" playsinline muted></video>
    </div>

    <script>
        // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 2: –£–±—Ä–∞–Ω—ã –ø—Ä–æ–±–µ–ª—ã –≤ BASE_URL (—É —Ç–µ–±—è —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –Ω–æ –æ—Å—Ç–∞–≤–∏–º –Ω–∞ –≤—Å—è–∫–∏–π)
        const BASE_URL = "https://conscienceann.github.io/myweek-mvp/videos/";

        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('id') || 'test123';

        const mood1 = urlParams.get('m1') || '1';
        const mood2 = urlParams.get('m2') || '2';
        const mood3 = urlParams.get('m3') || '3';

        const videoMap = {
            intro: `${BASE_URL}intro.mp4`,
            mood_1: `${BASE_URL}mood_1.mp4`,
            mood_2: `${BASE_URL}mood_2.mp4`,
            mood_3: `${BASE_URL}mood_3.mp4`,
            outro: `${BASE_URL}outro.mp4`
        };

        const sequence = [
            'intro',
            `mood_${mood1}`,
            `mood_${mood2}`,
            `mood_${mood3}`,
            'outro'
        ];

        let currentVideoIndex = 0;
        let videoPlayer = document.getElementById('videoPlayer'); // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 3: –¥–µ–ª–∞–µ–º let –≤–º–µ—Å—Ç–æ const ‚Äî –±—É–¥–µ–º –æ–±–Ω–æ–≤–ª—è—Ç—å
        const playerContainer = document.getElementById('playerContainer');

        function playNextVideo() {
            if (currentVideoIndex >= sequence.length) {
                showEndScreen();
                return;
            }

            const key = sequence[currentVideoIndex];
            const url = videoMap[key];

            if (!url) {
                console.error(`–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ: ${key}`);
                currentVideoIndex++;
                playNextVideo();
                return;
            }

            videoPlayer.src = url;

            // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 4: –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–ø–ª–µ—è ‚Äî —Ç–µ–ø–µ—Ä—å –æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —ç–ª–µ–º–µ–Ω—Ç –∏ –≤–µ—à–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            videoPlayer.play().catch(e => {
                console.log("–ê–≤—Ç–æ–ø–ª–µ–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É.");

                // –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∫–Ω–æ–ø–∫–æ–π –∏ –Ω–æ–≤—ã–º –≤–∏–¥–µ–æ-—ç–ª–µ–º–µ–Ω—Ç–æ–º
                playerContainer.innerHTML = `
                    <button id="startButton" style="padding: 15px 30px; font-size: 18px; background: #ff5e5b; color: white; border: none; border-radius: 8px; cursor: pointer;">
                        ‚ñ∂Ô∏è –ù–∞–∂–º–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å
                    </button>
                    <!-- üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 5: muted –¥–æ–±–∞–≤–ª–µ–Ω –∏ –∑–¥–µ—Å—å -->
                    <video id="videoPlayer" playsinline muted style="width: 100%; max-width: 600px; margin-top: 20px;"></video>
                `;

                // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 6: –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ videoPlayer ‚Äî –∏–Ω–∞—á–µ –æ–Ω —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã–π —É–¥–∞–ª—ë–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
                videoPlayer = document.getElementById('videoPlayer');

                // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 7: –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ 'ended' –Ω–∞ –ù–û–í–´–ô —ç–ª–µ–º–µ–Ω—Ç ‚Äî –∏–Ω–∞—á–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–µ–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç
                videoPlayer.addEventListener('ended', () => {
                    currentVideoIndex++;
                    playNextVideo();
                });

                // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 8: –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ–º –≤–∏–¥–µ–æ
                document.getElementById('startButton').addEventListener('click', () => {
                    videoPlayer.play();
                    document.getElementById('startButton').remove(); // —É–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
                });
            });

            // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 9: –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ 'ended' –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ ‚Äî –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∞–≤—Ç–æ–ø–ª–µ–π —Å—Ä–∞–±–æ—Ç–∞–ª
            videoPlayer.addEventListener('ended', () => {
                currentVideoIndex++;
                playNextVideo();
            });
        }

        function showEndScreen() {
            playerContainer.innerHTML = `
                <div style="color: white; text-align: center; padding: 20px;">
                    <h2>üé¨ –¢–≤–æ—è –Ω–µ–¥–µ–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
                    <button id="shareBtn">üì≤ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                    <button id="restartBtn">üîÑ –ù–æ–≤–∞—è –Ω–µ–¥–µ–ª—è</button>
                </div>
            `;

            document.getElementById('shareBtn').addEventListener('click', shareResult);
            document.getElementById('restartBtn').addEventListener('click', () => {
                // üÜï –ò–ó–ú–ï–ù–ï–ù–ò–ï 10: –£–±—Ä–∞–ª –ø—Ä–æ–±–µ–ª –≤ URL (–µ—Å–ª–∏ —Ç—ã —Å–æ–∑–¥–∞—à—å –±–æ—Ç–∞ ‚Äî –∑–∞–º–µ–Ω–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π)
                window.location.href = 'https://t.me/—Ç–≤–æ–π_–±–æ—Ç';
            });
        }

        function shareResult() {
            const shareText = `–ú–û–Ø –ù–ï–î–ï–õ–Ø –ö–ê–ö...\n–ü–Ω: –∫–∞–∫ —Ç–µ–ª–µ—Ñ–æ–Ω —Å 3% üì±\n–í—Ç: –∫–∞–∫ –∫–æ—Ç –Ω–∞ —Å–æ–ª–Ω—Ü–µ üê±\n–°—Ä: –∫–∞–∫ –≥–µ—Ä–æ–π üéÆ\n#–ú–æ—è–ù–µ–¥–µ–ª—è–ö–∞–∫\n${window.location.href}`;
            if (navigator.share) {
                navigator.share({ title: '–ú–æ—è –Ω–µ–¥–µ–ª—è –∫–∞–∫...', text: shareText });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ! –í—Å—Ç–∞–≤—å –≤ —á–∞—Ç –∏–ª–∏ —Å—Ç–æ—Ä–∏—Å ‚úÖ");
                });
            }
        }

        // –°—Ç–∞—Ä—Ç—É–µ–º!
        playNextVideo();
    </script>
</body>
</html>